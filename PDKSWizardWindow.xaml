<Window x:Class="WebScraper.PDKSWizardWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:WebScraper"
        mc:Ignorable="d"
        Title="PDKS Veri İşlemleri Sihirbazı"
        WindowState="Maximized"
        WindowStartupLocation="CenterScreen"
        FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
        Background="#F5F5F5"
        UseLayoutRounding="True"
        SnapsToDevicePixels="True"
        TextOptions.TextRenderingMode="ClearType"
        TextOptions.TextFormattingMode="Display"
        RenderOptions.BitmapScalingMode="HighQuality">

    <Window.Resources>
        <!-- Global TextBlock Style - Net görüntü için -->
        <Style TargetType="TextBlock">
            <Setter Property="TextOptions.TextRenderingMode" Value="ClearType"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="RenderOptions.BitmapScalingMode" Value="HighQuality"/>
            <Setter Property="UseLayoutRounding" Value="True"/>
        </Style>
        
        <!-- Modern UI Styles -->
        <Style x:Key="WizardButton" TargetType="Button">
            <Setter Property="Background" Value="#2196F3"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,10"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="FontFamily" Value="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Border"
                                Background="{TemplateBinding Background}"
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter x:Name="ContentPresenter"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Border" Property="Background" Value="#CCCCCC"/>
                                <Setter TargetName="ContentPresenter" Property="Opacity" Value="0.5"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#1976D2"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="StepIndicator" TargetType="Border">
            <Setter Property="Width" Value="40"/>
            <Setter Property="Height" Value="40"/>
            <Setter Property="CornerRadius" Value="20"/>
            <Setter Property="BorderThickness" Value="2"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="Margin" Value="5"/>
        </Style>

        <Style x:Key="ActiveStepIndicator" TargetType="Border" BasedOn="{StaticResource StepIndicator}">
            <Setter Property="BorderBrush" Value="#2196F3"/>
            <Setter Property="Background" Value="#2196F3"/>
        </Style>

        <Style x:Key="CompletedStepIndicator" TargetType="Border" BasedOn="{StaticResource StepIndicator}">
            <Setter Property="BorderBrush" Value="#4CAF50"/>
            <Setter Property="Background" Value="#4CAF50"/>
        </Style>

        <local:LogoPathToImageConverter x:Key="LogoPathToImageConverter"/>
    </Window.Resources>

    <Grid UseLayoutRounding="True"
          TextOptions.TextRenderingMode="ClearType"
          TextOptions.TextFormattingMode="Display"
          RenderOptions.BitmapScalingMode="HighQuality">
        <!-- Ana Grid -->
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="White" Padding="20" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>

                <!-- Header Üst Kısım -->
                <Grid Grid.Row="0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Logo -->
                    <Image Grid.Column="0"
                            Source="pack://application:,,,/sadece logo.png"
                            Width="50"
                            Height="50"
                            Margin="0,0,20,0"/>

                    <!-- Başlık -->
                    <StackPanel Grid.Column="1" VerticalAlignment="Center">
                        <TextBlock Text="PDKS Veri İşlemleri Sihirbazı"
                                    FontSize="24"
                                    FontFamily="pack://application:,,,/Fonts/Poppins-Bold.ttf#Poppins"
                                    Foreground="#333"/>
                        <TextBlock x:Name="StepTitleText"
                                    Text="Adım 1: Vio Şablonu Seçimi"
                                    FontSize="18"
                                    FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                    Foreground="#666"
                                    Margin="0,5,0,0"/>
                    </StackPanel>

                    <!-- Calendar Button -->
                    <Button Grid.Column="2"
                            x:Name="btnHeaderCalendar"
                            Style="{StaticResource WizardButton}"
                            Background="#4CAF50"
                            Width="120"
                            Height="40"
                            Margin="0,0,10,0"
                            Click="btnHeaderCalendar_Click"
                            ToolTip="Resmi tatil takvimini aç">
                        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text=""
                                       FontFamily="Segoe MDL2 Assets"
                                       FontSize="18"
                                       Margin="0,0,8,0"
                                       VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="1"
                                       Text="Takvim"
                                       VerticalAlignment="Center"/>
                        </Grid>
                    </Button>

                    <!-- Previous Month Data Button -->
                    <Button Grid.Column="3"
                            x:Name="btnCarryOverView"
                            Style="{StaticResource WizardButton}"
                            Background="#6D28D9"
                            Width="170"
                            Height="40"
                            Margin="0,0,10,0"
                            Click="btnCarryOverView_Click"
                            ToolTip="Hareket kayıtlarını görüntüle (herhangi bir ay seçilebilir)">
                        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text=""
                                       FontFamily="Segoe MDL2 Assets"
                                       FontSize="18"
                                       Margin="0,0,8,0"
                                       VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="1"
                                       Text="Hareket Kayıtları"
                                       VerticalAlignment="Center"/>
                        </Grid>
                    </Button>

                    <!-- Logs Button -->
                    <Button Grid.Column="4"
                            x:Name="btnLogs"
                            Style="{StaticResource WizardButton}"
                            Background="#FF9800"
                            Width="110"
                            Height="40"
                            Margin="0,0,10,0"
                            Click="btnLogs_Click"
                            ToolTip="Uygulama Logları">
                        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text=""
                                       FontFamily="Segoe MDL2 Assets"
                                       FontSize="18"
                                       Margin="0,0,8,0"
                                       VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="1"
                                       Text="Loglar"
                                       VerticalAlignment="Center"/>
                        </Grid>
                    </Button>

                    <!-- Python Installer Button -->
                    <Button Grid.Column="5"
                            x:Name="btnPythonInstaller"
                            Style="{StaticResource WizardButton}"
                            Background="#4CAF50"
                            Width="140"
                            Height="40"
                            Margin="0,0,10,0"
                            Click="btnPythonInstaller_Click"
                            ToolTip="Python Kurulumunu Kontrol Et ve Kur">
                        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <Image Grid.Column="0"
                                   Source="pack://application:,,,/python-logo-only.png"
                                   Width="20" 
                                   Height="20"
                                   Margin="0,0,8,0"
                                   VerticalAlignment="Center"
                                   Stretch="Uniform"/>
                            <TextBlock Grid.Column="1"
                                       Text="Python"
                                       VerticalAlignment="Center"/>
                        </Grid>
                    </Button>

                    <!-- Settings Button -->
                    <Button Grid.Column="6"
                            x:Name="btnSettings"
                            Style="{StaticResource WizardButton}"
                            Background="#2196F3"
                            Width="200"
                            Height="40"
                            Margin="0,0,10,0"
                            Click="btnSettings_Click"
                            ToolTip="Firma ve Sistem Ayarları">
                        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text=""
                                       FontFamily="Segoe MDL2 Assets"
                                       FontSize="18"
                                       Margin="0,0,8,0"
                                       VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="1"
                                       Text="Firmalar ve Ayarları"
                                       VerticalAlignment="Center"/>
                        </Grid>
                    </Button>

                    <!-- Close Button -->
                    <Button Grid.Column="7"
                            x:Name="btnClose"
                            Style="{StaticResource WizardButton}"
                            Background="#F44336"
                            Width="110"
                            Height="40"
                            Click="btnClose_Click">
                        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBlock Grid.Column="0"
                                       Text=""
                                       FontFamily="Segoe MDL2 Assets"
                                       FontSize="18"
                                       Margin="0,0,8,0"
                                       VerticalAlignment="Center"/>
                            <TextBlock Grid.Column="1"
                                       Text="Kapat"
                                       VerticalAlignment="Center"/>
                        </Grid>
                    </Button>
                </Grid>

                <!-- Adım İlerleme Çubuğu -->
                <Grid Grid.Row="1" Margin="0,24,0,0" HorizontalAlignment="Center">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="120"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Step 1 -->
                    <StackPanel Grid.Column="0"
                                Orientation="Vertical"
                                HorizontalAlignment="Center">
                        <TextBlock Text="Firma Seçimi"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Margin="0,0,0,6"
                                   FontSize="13"
                                   Foreground="#4F5B74"/>
                        <Button x:Name="btnStep1"
                                Click="btnStep1_Click"
                                Background="Transparent"
                                BorderThickness="0"
                                Padding="0"
                                Cursor="Hand"
                                ToolTip="Firma Seçimi adımına git">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="Transparent"
                                                        CornerRadius="20"
                                                        Padding="5">
                                                    <ContentPresenter/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background">
                                                <Setter.Value>
                                                    <SolidColorBrush Color="#E3F2FD" Opacity="0.6"/>
                                                </Setter.Value>
                                            </Setter>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                            <Border x:Name="Step1Indicator"
                                    Style="{StaticResource ActiveStepIndicator}">
                                <TextBlock Text="1"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Foreground="White"
                                           FontWeight="Bold"/>
                            </Border>
                        </Button>
                </StackPanel>

                <!-- Line 1-2 -->
                    <Border Grid.Column="1"
                            Height="2"
                            Background="#D0D7E5"
                            VerticalAlignment="Center"/>

                <!-- Step 2 -->
                    <StackPanel Grid.Column="2"
                                Orientation="Vertical"
                                HorizontalAlignment="Center">
                        <TextBlock Text="Şablon Seçimi"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Margin="0,0,0,6"
                                   FontSize="13"
                                   Foreground="#4F5B74"/>
                        <Button x:Name="btnStep2"
                                Click="btnStep2_Click"
                                Background="Transparent"
                                BorderThickness="0"
                                Padding="0"
                                Cursor="Hand"
                                ToolTip="Şablon Seçimi adımına git">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="Transparent"
                                                        CornerRadius="20"
                                                        Padding="5">
                                                    <ContentPresenter/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background">
                                                <Setter.Value>
                                                    <SolidColorBrush Color="#E3F2FD" Opacity="0.6"/>
                                                </Setter.Value>
                                            </Setter>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                            <Border x:Name="Step2Indicator"
                                    Style="{StaticResource StepIndicator}">
                                <TextBlock Text="2"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Foreground="#666"
                                           FontWeight="Bold"/>
                            </Border>
                        </Button>
                </StackPanel>

                <!-- Line 2-3 -->
                    <Border Grid.Column="3"
                            Height="2"
                            Background="#D0D7E5"
                            VerticalAlignment="Center"/>

                <!-- Step 3 -->
                    <StackPanel Grid.Column="4"
                                Orientation="Vertical"
                                HorizontalAlignment="Center">
                        <TextBlock Text="PDKS Verileri"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Margin="0,0,0,6"
                                   FontSize="13"
                                   Foreground="#4F5B74"/>
                        <Button x:Name="btnStep3"
                                Click="btnStep3_Click"
                                Background="Transparent"
                                BorderThickness="0"
                                Padding="0"
                                Cursor="Hand"
                                ToolTip="PDKS Verileri adımına git">
                            <Button.Style>
                                <Style TargetType="Button">
                                    <Setter Property="Template">
                                        <Setter.Value>
                                            <ControlTemplate TargetType="Button">
                                                <Border Background="Transparent"
                                                        CornerRadius="20"
                                                        Padding="5">
                                                    <ContentPresenter/>
                                                </Border>
                                            </ControlTemplate>
                                        </Setter.Value>
                                    </Setter>
                                    <Style.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background">
                                                <Setter.Value>
                                                    <SolidColorBrush Color="#E3F2FD" Opacity="0.6"/>
                                                </Setter.Value>
                                            </Setter>
                                        </Trigger>
                                    </Style.Triggers>
                                </Style>
                            </Button.Style>
                            <Border x:Name="Step3Indicator"
                                    Style="{StaticResource StepIndicator}">
                                <TextBlock Text="3"
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           Foreground="#666"
                                           FontWeight="Bold"/>
                            </Border>
                        </Button>
                </StackPanel>

            </Grid>

            </Grid>
        </Border>

        <!-- Step İçerik -->
        <Grid Grid.Row="1" Margin="20">
            <!-- Step Content -->
            <Border Background="White"
                    CornerRadius="10"
                    Padding="30"
                    BorderBrush="#E0E0E0"
                    BorderThickness="1">
                <Border.Effect>
                    <DropShadowEffect Color="LightGray" Direction="270" ShadowDepth="3" Opacity="0.2"/>
                </Border.Effect>

                <!-- Step Content Container -->
                <Grid x:Name="ContentContainer">
                    <Grid x:Name="StepContentGrid">
                    <!-- Step 1 Content -->
                    <Grid x:Name="Step1Content" Visibility="Visible">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <Border Grid.Row="0"
                                Background="#E8F0FE"
                                CornerRadius="12"
                                Padding="20"
                                BorderBrush="#D7E2FF"
                                BorderThickness="1">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <Border Width="48"
                                        Height="48"
                                        CornerRadius="24"
                                        Background="#1A73E8"
                                        HorizontalAlignment="Left"
                                        VerticalAlignment="Center">
                                    <TextBlock Text=""
                                               FontFamily="Segoe MDL2 Assets"
                                               Foreground="White"
                                               FontSize="22"
                                               HorizontalAlignment="Center"
                                               VerticalAlignment="Center"/>
                                </Border>

                                <StackPanel Grid.Column="1"
                                            Margin="16,0,0,0"
                                            VerticalAlignment="Center">
                                    <TextBlock Text="Firma Seçimi"
                                               FontSize="20"
                                           FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins"
                                               Foreground="#1A237E"/>
                                    <TextBlock Text="Devam etmek için listeden bir firma seçin, ardından detayları ve şablon ayarlarını kontrol edin."
                                           FontSize="14"
                                           FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                               Foreground="#3C4048"
                                               Margin="0,6,0,0"
                                           TextWrapping="Wrap"/>
                            </StackPanel>
                            </Grid>
                        </Border>

                        <Grid Grid.Row="1" Margin="0,24,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="2*"/>
                                <ColumnDefinition Width="3*"/>
                            </Grid.ColumnDefinitions>

                            <Border Grid.Column="0"
                                    Background="#F8FAFC"
                                    CornerRadius="12"
                                    Padding="20"
                                    BorderBrush="#E2E8F0"
                                    BorderThickness="1"
                                    Margin="0,0,24,0">
                                <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                                    <Grid Grid.Row="0">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="Firma Listesi"
                                                       FontSize="16"
                                                       FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins"
                                                       Foreground="#1E293B"/>
                                            <TextBlock Text="Seçmek istediğiniz firmayı listeden tıklayın."
                                                       FontSize="13"
                                                       FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                                       Foreground="#64748B"
                                                       Margin="0,4,0,12"
                                                       TextWrapping="Wrap"/>
                                        </StackPanel>
                                        <Button Grid.Column="1"
                                                x:Name="btnQuickAddCompany"
                                                Style="{StaticResource WizardButton}"
                                                Background="#1A73E8"
                                                Padding="18,8"
                                                Margin="0,0,0,0"
                                                HorizontalAlignment="Right"
                                                VerticalAlignment="Top"
                                                Click="btnQuickAddCompany_Click">
                                            <StackPanel Orientation="Horizontal"
                                                        HorizontalAlignment="Center"
                                                        VerticalAlignment="Center"
                                                        TextElement.FontFamily="pack://application:,,,/Fonts/Poppins-Medium.ttf#Poppins"
                                                        TextElement.FontSize="15">
                                                <TextBlock Text=""
                                                           FontFamily="Segoe MDL2 Assets"
                                                           FontSize="16"
                                                           Margin="0,0,6,0"
                                                           VerticalAlignment="Center"/>
                                                <TextBlock Text="Yeni Firma +"
                                                           VerticalAlignment="Center"/>
                                            </StackPanel>
                                        </Button>
                                        <Button Grid.Column="2"
                                                x:Name="btnToggleCompanyFilter"
                                                Style="{StaticResource WizardButton}"
                                                Background="#1E3A8A"
                                                Width="48"
                                                Padding="0"
                                                Margin="10,0,0,0"
                                                HorizontalAlignment="Right"
                                                VerticalAlignment="Top"
                                                Click="btnToggleCompanyFilter_Click"
                                                ToolTip="Firma filtresi">
                                            <TextBlock Text="&#xE71C;"
                                                       FontFamily="Segoe MDL2 Assets"
                                                       FontSize="20"
                                                       VerticalAlignment="Center"
                                                       HorizontalAlignment="Center"/>
                                        </Button>
                                    </Grid>

                                    <Popup x:Name="CompanyFilterPopup"
                                           PlacementTarget="{Binding ElementName=btnToggleCompanyFilter}"
                                           Placement="Bottom"
                                           StaysOpen="False"
                                           AllowsTransparency="True"
                                           PopupAnimation="Fade"
                                           Opened="CompanyFilterPopup_Opened"
                                           Closed="CompanyFilterPopup_Closed">
                                        <Border Background="White"
                                                CornerRadius="10"
                                                BorderBrush="#CBD5E1"
                                                BorderThickness="1"
                                                Padding="16">
                                            <Border.Effect>
                                                <DropShadowEffect Color="#1F2937"
                                                                  BlurRadius="14"
                                                                  ShadowDepth="4"
                                                                  Opacity="0.18"/>
                                            </Border.Effect>
                                            <StackPanel>
                                                <TextBlock Text="Firma filtresi"
                                                           FontSize="14"
                                                           FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins"
                                                           Foreground="#1F2937"/>
                                                <TextBlock Text="Firma adı veya kodunu yazın."
                                                           FontSize="12"
                                                           FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                                           Foreground="#64748B"
                                                           Margin="0,4,0,10"/>
                                                <TextBox x:Name="CompanyFilterTextBox"
                                                         Width="220"
                                                         Height="34"
                                                         Padding="10,4"
                                                         Background="#F8FAFC"
                                                         BorderBrush="#CBD5E1"
                                                         BorderThickness="1"
                                                         FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                                         FontSize="14"
                                                         TextChanged="CompanyFilterTextBox_TextChanged"
                                                         PreviewKeyDown="CompanyFilterTextBox_PreviewKeyDown"/>
                                                <StackPanel Orientation="Horizontal"
                                                            HorizontalAlignment="Right"
                                                            Margin="0,12,0,0">
                                                    <Button Content="Temizle"
                                                            Style="{StaticResource WizardButton}"
                                                            Background="#6B7280"
                                                            Padding="16,6"
                                                            Height="34"
                                                            Click="btnClearCompanyFilter_Click"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </Border>
                                    </Popup>

                                    <Border Grid.Row="1"
                                            Height="1"
                                            Background="#E2E8F0"
                                            Margin="0,0,0,12"/>

                                    <Grid Grid.Row="2">
                                        <ListBox x:Name="CompanyListBox"
                                                 Background="White"
                                                 BorderBrush="#E0E0E0"
                                                 BorderThickness="1"
                                                 ItemsSource="{Binding}"
                                                 SelectedValuePath="CompanyCode"
                                                 SelectionChanged="CompanyListBox_SelectionChanged"
                                                 ScrollViewer.VerticalScrollBarVisibility="Auto"
                                                 MinHeight="260">
                                <ListBox.ItemContainerStyle>
                                    <Style TargetType="ListBoxItem">
                                        <Setter Property="FocusVisualStyle" Value="{x:Null}"/>
                                        <Setter Property="Template">
                                            <Setter.Value>
                                                <ControlTemplate TargetType="ListBoxItem">
                                                    <Border x:Name="Border"
                                                                    Padding="10"
                                                                    Background="Transparent"
                                                            SnapsToDevicePixels="true">
                                                        <ContentPresenter/>
                                                    </Border>
                                                    <ControlTemplate.Triggers>
                                                        <Trigger Property="IsSelected" Value="true">
                                                                    <Setter TargetName="Border" Property="Background" Value="#E3F2FD"/>
                                                            <Setter TargetName="Border" Property="BorderBrush" Value="#BBDEFB"/>
                                                            <Setter TargetName="Border" Property="BorderThickness" Value="1"/>
                                                                    <Setter Property="Foreground" Value="#1565C0"/>
                                                        </Trigger>
                                                        <Trigger Property="IsMouseOver" Value="true">
                                                                    <Setter TargetName="Border" Property="Background" Value="#F1F5F9"/>
                                                                    <Setter Property="Foreground" Value="#1E88E5"/>
                                                        </Trigger>
                                                        <Trigger Property="IsEnabled" Value="false">
                                                            <Setter Property="Foreground" Value="#888888"/>
                                                        </Trigger>
                                                    </ControlTemplate.Triggers>
                                                </ControlTemplate>
                                            </Setter.Value>
                                        </Setter>
                                    </Style>
                                </ListBox.ItemContainerStyle>
                                <ListBox.ItemTemplate>
                                    <DataTemplate>
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="Auto"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            <Image Width="28"
                                                   Height="28"
                                                   Margin="0,0,10,0"
                                                   VerticalAlignment="Center"
                                                   Source="{Binding LogoPath, Converter={StaticResource LogoPathToImageConverter}}"
                                                   Stretch="Uniform"/>
                                            <TextBlock Grid.Column="1"
                                                       Text="{Binding CompanyName}"
                                                       FontSize="14"
                                                       VerticalAlignment="Center"
                                                       Foreground="#1E293B"/>
                                            <Button Grid.Column="2"
                                                    Style="{StaticResource WizardButton}"
                                                    Background="#22C55E"
                                                    Width="38"
                                                    Height="30"
                                                    Margin="8,0,0,0"
                                                    Padding="0"
                                                    HorizontalAlignment="Right"
                                                    VerticalAlignment="Center"
                                                    Focusable="False"
                                                    Click="CompanyEditButton_Click"
                                                    Tag="{Binding}"
                                                    ToolTip="Bu firmayı düzenle">
                                                <TextBlock Text="&#xE70F;"
                                                           FontFamily="Segoe MDL2 Assets"
                                                           FontSize="16"
                                                           HorizontalAlignment="Center"
                                                           VerticalAlignment="Center"/>
                                            </Button>
                                        </Grid>
                                    </DataTemplate>
                                </ListBox.ItemTemplate>
                                        </ListBox>
                                    </Grid>
                                </Grid>
                            </Border>

                            <Grid Grid.Column="1">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                <Border x:Name="CompanyInfoBorder" Grid.Row="0"
                                    Visibility="Collapsed"
                                    Background="#F8F9FA"
                                    CornerRadius="12"
                                    Padding="20"
                                    BorderBrush="#D3D8DE"
                                    BorderThickness="1.5"
                                    MinHeight="240"
                                    VerticalAlignment="Stretch">
                                <StackPanel>
                                    <TextBlock Text="ℹ️ Firma Bilgileri"
                                               FontSize="18"
                                               FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins"
                                               Foreground="#495057"
                                               Margin="0,0,0,15"/>

                                    <StackPanel x:Name="CompanyInfoStack"
                                                TextElement.FontSize="15"
                                                TextElement.FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                                TextElement.Foreground="#4B5563"
                                                Margin="0">
                                            <UniformGrid Columns="3"
                                                         HorizontalAlignment="Stretch"
                                                         VerticalAlignment="Center"
                                                         Margin="0"
                                                         Rows="3">

                                                <Border Background="White"
                                                        Margin="6"
                                                        Padding="14"
                                                        CornerRadius="10"
                                                        BorderBrush="#E5E7EB"
                                                        BorderThickness="1"
                                                        MinHeight="170">
                                                    <StackPanel>
                                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12" VerticalAlignment="Center">
                                                            <Border Width="32" Height="32" CornerRadius="16" Background="#E9F3FF" Margin="0,0,10,0">
                                                                <TextBlock Text="" FontFamily="Segoe MDL2 Assets" Foreground="#1E66D0" FontSize="16" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                            </Border>
                                                            <TextBlock Text="Firma Kodu" FontSize="13" FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins" Foreground="#000000" VerticalAlignment="Center"/>
                                                        </StackPanel>
                                                        <TextBlock x:Name="CompanyCodeText" FontSize="15" FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins" Foreground="#2B3035" TextWrapping="Wrap" TextTrimming="CharacterEllipsis"/>
                                                    </StackPanel>
                                                </Border>

                                                <Border Background="White"
                                                        Margin="6"
                                                        Padding="14"
                                                        CornerRadius="10"
                                                        BorderBrush="#E5E7EB"
                                                        BorderThickness="1"
                                                        MinHeight="170">
                                                    <StackPanel>
                                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12" VerticalAlignment="Center">
                                                            <Border Width="36" Height="36" CornerRadius="18" Background="#E8F6ED" Margin="0,0,10,0">
                                                                <TextBlock Text="" FontFamily="Segoe MDL2 Assets" Foreground="#2E7D32" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                            </Border>
                                                            <TextBlock Text="Firma Adı" FontSize="14" FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins" Foreground="#000000" VerticalAlignment="Center"/>
                                                        </StackPanel>
                                                        <TextBlock x:Name="CompanyNameText" FontSize="17" FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins" Foreground="#2B3035" TextWrapping="Wrap"/>
                                                    </StackPanel>
                                                </Border>

                                                <Border Background="White"
                                                        Margin="6"
                                                        Padding="14"
                                                        CornerRadius="10"
                                                        BorderBrush="#E5E7EB"
                                                        BorderThickness="1"
                                                        MinHeight="170">
                                                    <StackPanel>
                                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12" VerticalAlignment="Center">
                                                            <Border Width="36" Height="36" CornerRadius="18" Background="#FFF4E5" Margin="0,0,10,0">
                                                                <TextBlock Text="" FontFamily="Segoe MDL2 Assets" Foreground="#EF6C00" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                            </Border>
                                                            <TextBlock Text="Vardiya Kuralları" FontSize="14" FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins" Foreground="#000000" VerticalAlignment="Center"/>
                                                        </StackPanel>
                                                        <Border Background="#F8FAFC"
                                                                BorderBrush="#E2E8F0"
                                                                BorderThickness="1"
                                                                CornerRadius="8"
                                                                Padding="12"
                                                                Margin="0,4,0,0">
                                                            <StackPanel>
                                                                <TextBlock x:Name="ShiftRuleCountText"
                                                                           Text="0"
                                                                           FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                                                           FontSize="14"
                                                                           Foreground="#2B3035"/>
                                                                <TextBlock x:Name="TemplateModeInfoText"
                                                                           Text="Şablon Modu: -"
                                                                           FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                                                           FontSize="13"
                                                                           Foreground="#0EA5E9"
                                                                           Margin="0,6,0,0"/>
                                                            </StackPanel>
                                                        </Border>
                                                    </StackPanel>
                                                </Border>

                                                <Border Background="White"
                                                        Margin="6"
                                                        Padding="14"
                                                        CornerRadius="10"
                                                        BorderBrush="#E5E7EB"
                                                        BorderThickness="1"
                                                        MinHeight="170">
                                                    <StackPanel>
                                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12" VerticalAlignment="Center">
                                                            <Border Width="36" Height="36" CornerRadius="18" Background="#FFE9EC" Margin="0,0,10,0">
                                                                <TextBlock Text="" FontFamily="Segoe MDL2 Assets" Foreground="#D32F2F" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                            </Border>
                                                            <TextBlock Text="ERP Şablonu" FontSize="14" FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins" Foreground="#000000" VerticalAlignment="Center"/>
                                                        </StackPanel>
                                                        <TextBlock x:Name="ErpTemplateText" FontSize="15" FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins" Foreground="#2B3035" TextWrapping="Wrap"/>
                                                    </StackPanel>
                                                </Border>

                                                <Border Background="White"
                                                        Margin="6"
                                                        Padding="14"
                                                        CornerRadius="10"
                                                        BorderBrush="#E5E7EB"
                                                        BorderThickness="1"
                                                        MinHeight="170">
                                                    <Grid>
                                                        <Grid.RowDefinitions>
                                                            <RowDefinition Height="Auto"/>
                                                            <RowDefinition Height="*"/>
                                                            <RowDefinition Height="Auto"/>
                                                        </Grid.RowDefinitions>
                                                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,12" VerticalAlignment="Center">
                                                                <Border Width="36" Height="36" CornerRadius="18" Background="#E9F3FF" Margin="0,0,10,0">
                                                                    <TextBlock Text="" FontFamily="Segoe MDL2 Assets" Foreground="#1E66D0" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                                </Border>
                                                                <TextBlock Text="Bordro Dönemi" FontSize="14" FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins" Foreground="#000000" VerticalAlignment="Center"/>
                                                            </StackPanel>
                                                        <TextBlock Grid.Row="1" x:Name="CompanyCalendarText" FontSize="15" FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins" Foreground="#2B3035" Text="Seçilmedi" TextWrapping="Wrap"/>
                                                        <Button Grid.Row="2"
                                                                x:Name="btnOpenCompanyCalendar"
                                                                Style="{StaticResource WizardButton}"
                                                                Background="#2196F3"
                                                                Width="40"
                                                                Height="36"
                                                                Padding="0"
                                                                Margin="0,12,0,0"
                                                                HorizontalAlignment="Left"
                                                                Click="btnOpenCompanyCalendar_Click">
                                                            <TextBlock Text=""
                                                                       FontFamily="Segoe MDL2 Assets"
                                                                       FontSize="18"
                                                                       HorizontalAlignment="Center"
                                                                       VerticalAlignment="Center"/>
                                                        </Button>
                                                    </Grid>
                                                </Border>

                                                <!-- Firma Logosu -->
                                                <Border Background="White"
                                                        Margin="6"
                                                        Padding="14"
                                                        CornerRadius="10"
                                                        BorderBrush="#E5E7EB"
                                                        BorderThickness="1"
                                                        MinHeight="170">
                                                    <StackPanel>
                                                        <StackPanel Orientation="Horizontal" Margin="0,0,0,12" VerticalAlignment="Center">
                                                            <Border Width="36" Height="36" CornerRadius="18" Background="#F3E8FF" Margin="0,0,10,0">
                                                                <TextBlock Text="&#xE7B3;" FontFamily="Segoe MDL2 Assets" Foreground="#9333EA" FontSize="18" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                                            </Border>
                                                            <TextBlock Text="Firma Logosu" FontSize="14" FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins" Foreground="#000000" VerticalAlignment="Center"/>
                                                        </StackPanel>
                                                        <Border Width="120" 
                                                                Height="120" 
                                                                BorderBrush="#E5E7EB" 
                                                                BorderThickness="1" 
                                                                CornerRadius="8"
                                                                Background="#F8F9FC"
                                                                HorizontalAlignment="Center"
                                                                VerticalAlignment="Center">
                                                            <Image x:Name="CompanyLogoImage"
                                                                   Stretch="Uniform"
                                                                   VerticalAlignment="Center"
                                                                   HorizontalAlignment="Center"
                                                                   MaxWidth="110"
                                                                   MaxHeight="110"/>
                                                        </Border>
                                                    </StackPanel>
                                                </Border>

                                        </UniformGrid>
                                    </StackPanel>

                                    <Popup x:Name="ShiftRulesPopup"
                                           Placement="Bottom"
                                           StaysOpen="False"
                                           AllowsTransparency="True"
                                           PopupAnimation="Fade">
                                        <Border Background="White"
                                                BorderBrush="#E0E0E0"
                                                BorderThickness="1"
                                                CornerRadius="6"
                                                Padding="15">
                                            <Border.Effect>
                                                <DropShadowEffect Color="#55000000"
                                                                  Direction="315"
                                                                  ShadowDepth="4"
                                                                  BlurRadius="8"
                                                                  Opacity="0.4"/>
                                            </Border.Effect>
                                            <StackPanel Width="260">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                    </Grid.ColumnDefinitions>
                                                    <TextBlock Text="Vardiya Kuralları"
                                                               FontWeight="SemiBold"
                                                               Foreground="#333"
                                                               FontSize="15"
                                                               Grid.Column="0"
                                                               VerticalAlignment="Center"/>
                                                    <Button Content="✕"
                                                            Width="18"
                                                            Height="18"
                                                            Margin="10,0,0,0"
                                                            Padding="0"
                                                            HorizontalAlignment="Right"
                                                            VerticalAlignment="Center"
                                                            Grid.Column="1"
                                                            Style="{x:Null}"
                                                            Background="Transparent"
                                                            Foreground="#666"
                                                            BorderThickness="0"
                                                            Cursor="Hand"/>
                                                </Grid>

                                                <ItemsControl x:Name="ShiftRulesItemsControl">
                                                    <ItemsControl.Resources>
                                                        <Style TargetType="TextBlock">
                                                            <Setter Property="FontSize" Value="13"/>
                                                            <Setter Property="Foreground" Value="#555"/>
                                                            <Setter Property="TextWrapping" Value="Wrap"/>
                                                        </Style>
                                                    </ItemsControl.Resources>
                                                    <ItemsControl.ItemTemplate>
                                                        <DataTemplate>
                                                            <Border BorderBrush="#E0E0E0"
                                                                    BorderThickness="0,0,0,1"
                                                                    Padding="0,5,0,5">
                                                                <StackPanel>
                                                                    <TextBlock FontWeight="SemiBold"
                                                                               Text="{Binding Title}"/>
                                                                    <TextBlock Margin="0,2,0,0"
                                                                               Text="{Binding Details}"/>
                                                                </StackPanel>
                                                            </Border>
                                                        </DataTemplate>
                                                    </ItemsControl.ItemTemplate>
                                                </ItemsControl>

                                                <TextBlock x:Name="ShiftRulesEmptyText"
                                                           Text="Bu firmaya ait vardiya kuralı bulunmuyor."
                                                           Foreground="#888"
                                                           FontSize="13"
                                                           Visibility="Collapsed"
                                                           TextWrapping="Wrap"/>
                                            </StackPanel>
                                        </Border>
                                    </Popup>
                                </StackPanel>
                            </Border>

                                        </Grid>
                        </Grid>
                    </Grid>

                    <!-- Step 2 Content -->
                    <Grid x:Name="Step2Content" Visibility="Collapsed">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <TextBlock Grid.Row="0"
                                   Text="PDKS ham verilerini yükleyin ve personel eşleştirmesi yapın"
                                   FontSize="20"
                                   FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins"
                                   Foreground="#333"
                                   Margin="0,0,0,20"/>

                        <Border Grid.Row="1"
                                Background="#FFF3E0"
                                CornerRadius="8"
                                Padding="20"
                                Margin="0,0,0,20"
                                BorderBrush="#FF9800"
                                BorderThickness="1">
                            <StackPanel>
                                <TextBlock Text="📊 PDKS Veri Yükleme"
                                           FontSize="18"
                                           FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins"
                                           Foreground="#E65100"
                                           Margin="0,0,0,14"/>

                                <TextBlock Text="Personel giriş-çıkış verilerini içeren PDKS dosyasını seçin. Sistem otomatik olarak Vio şablonundaki personel kayıtlarıyla eşleştirecektir."
                                           FontSize="15"
                                           FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                           Foreground="#424242"
                                           TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>

                        <Grid Grid.Row="2">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <Button Grid.Row="0"
                                    x:Name="btnLoadPDKSData"
                                    Content="📁 PDKS Dosyasını Seç"
                                    Style="{StaticResource WizardButton}"
                                    Background="#FF9800"
                                    HorizontalAlignment="Center"
                                    Margin="0,20,0,0"
                                    Click="btnLoadPDKSData_Click"/>

                            <Border Grid.Row="1"
                                    x:Name="PDKSDataPreviewBorder"
                                    Visibility="Collapsed"
                                    Background="#FFFFFF"
                                    CornerRadius="16"
                                    Padding="26"
                                    Margin="0,24,0,0">
                                <Border.Effect>
                                    <DropShadowEffect Color="#1F000000" BlurRadius="18" ShadowDepth="0" Opacity="0.15"/>
                                </Border.Effect>
                                <StackPanel>
                                    <Grid Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <StackPanel Grid.Column="0">
                                            <TextBlock Text="📊 Veri Analizi Sonuçları"
                                                       FontSize="20"
                                                       FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins"
                                                       Foreground="#1F2937"/>
                                            <TextBlock x:Name="PDKSDataDetailsText"
                                                       FontSize="14"
                                                       FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                                       Foreground="#6B7280"
                                                       TextWrapping="Wrap"
                                                       Margin="0,6,0,0"/>
                                            <StackPanel x:Name="PDKSDataInfoList"
                                                        Orientation="Vertical"
                                                        Margin="0,12,0,0"/>
                                        </StackPanel>
                                        <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Top">
                                            <Border Background="#EEF2FF" CornerRadius="10" Padding="14,10" MinWidth="130">
                                                <StackPanel>
                                                    <TextBlock Text="Toplam Kayıt" FontSize="12" Foreground="#6366F1" FontFamily="pack://application:,,,/Fonts/Poppins-Medium.ttf#Poppins"/>
                                                    <TextBlock x:Name="txtTotalRecords"
                                                               Text="0"
                                                               FontSize="20"
                                                               FontFamily="pack://application:,,,/Fonts/Poppins-Bold.ttf#Poppins"
                                                               Foreground="#312E81"/>
                                                </StackPanel>
                                            </Border>
                                            <Border Background="#ECFDF5" CornerRadius="10" Padding="14,10" MinWidth="130" Margin="12,0,0,0">
                                                <StackPanel>
                                                    <TextBlock Text="Eşleşen" FontSize="12" Foreground="#10B981" FontFamily="pack://application:,,,/Fonts/Poppins-Medium.ttf#Poppins"/>
                                                    <TextBlock x:Name="txtMatchedRecords"
                                                               Text="0"
                                                               FontSize="20"
                                                               FontFamily="pack://application:,,,/Fonts/Poppins-Bold.ttf#Poppins"
                                                               Foreground="#047857"/>
                                                </StackPanel>
                                            </Border>
                                            <Border Background="#FEF2F2" CornerRadius="10" Padding="14,10" MinWidth="130" Margin="12,0,0,0">
                                                <StackPanel>
                                                    <TextBlock Text="Eşleşmeyen" FontSize="12" Foreground="#F87171" FontFamily="pack://application:,,,/Fonts/Poppins-Medium.ttf#Poppins"/>
                                                    <TextBlock x:Name="txtUnmatchedRecords"
                                                               Text="0"
                                                               FontSize="20"
                                                               FontFamily="pack://application:,,,/Fonts/Poppins-Bold.ttf#Poppins"
                                                               Foreground="#B91C1C"/>
                                                </StackPanel>
                                            </Border>
                                        </StackPanel>
                                    </Grid>

                                    <Border Background="#F9FAFB"
                                            CornerRadius="12"
                                            Padding="16"
                                            BorderBrush="#E5E7EB"
                                            BorderThickness="1"
                                            Margin="0,0,0,12">
                                        <StackPanel>
                                            <TextBlock Text="İşlem Özeti"
                                                       FontSize="15"
                                                       FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins"
                                                       Foreground="#1F2937"
                                                       Margin="0,0,0,8"/>
                                            <TextBlock x:Name="PDKSStatusSummaryText"
                                                       Text="İşlem özeti oluşturulmadı."
                                                       FontSize="13"
                                                       FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                                       Foreground="#4B5563"
                                                       TextWrapping="Wrap"
                                                       Margin="0,0,0,12"/>
                                            <Button x:Name="btnShowPDKSStatus"
                                                    Content="İşlem Özetini Aç"
                                                    Style="{StaticResource WizardButton}"
                                                    Background="#2563EB"
                                                    Foreground="White"
                                                    HorizontalAlignment="Left"
                                                    Padding="14,6"
                                                    IsEnabled="False"
                                                    Click="btnShowPDKSStatus_Click"/>
                                        </StackPanel>
                                    </Border>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Grid>


                    <!-- Step 3 Content -->
                    <Grid x:Name="Step3Content" Visibility="Collapsed">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <!-- YENİ Badge (Sağ Üst) -->
                        <Border x:Name="NewBadge"
                                Background="#F44336"
                                CornerRadius="12"
                                Padding="12,6"
                                HorizontalAlignment="Right"
                                VerticalAlignment="Top"
                                Margin="0,8,12,0"
                                Panel.ZIndex="100">
                            <Border.Style>
                                <Style TargetType="Border">
                                    <Style.Triggers>
                                        <EventTrigger RoutedEvent="Border.Loaded">
                                            <BeginStoryboard>
                                                <Storyboard RepeatBehavior="Forever">
                                                    <DoubleAnimation Storyboard.TargetProperty="Opacity"
                                                                     From="1" 
                                                                     To="0.5" 
                                                                     Duration="0:0:1"
                                                                     AutoReverse="True"/>
                                                </Storyboard>
                                            </BeginStoryboard>
                                        </EventTrigger>
                                    </Style.Triggers>
                                </Style>
                            </Border.Style>
                            <TextBlock Text="YENİ"
                                       FontFamily="pack://application:,,,/Fonts/Poppins-Bold.ttf#Poppins"
                                       FontSize="11"
                                       FontWeight="Bold"
                                       Foreground="White"
                                       HorizontalAlignment="Center"
                                       VerticalAlignment="Center"/>
                        </Border>

                        <TextBlock Grid.Row="0"
                                   Text="Veri işleme ve ERP şablonuna aktarma"
                                   FontSize="20"
                                   FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins"
                                   Foreground="#333"
                                   Margin="0,0,0,20"/>

                        <Border Grid.Row="1"
                                Background="#E3F2FD"
                                CornerRadius="8"
                                Padding="20"
                                Margin="0,0,0,20"
                                BorderBrush="#2196F3"
                                BorderThickness="1">
                            <StackPanel>
                                <TextBlock Text="🚀 Veri İşleme ve Aktarma"
                                           FontSize="18"
                                           FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins"
                                           Foreground="#1976D2"
                                           Margin="0,0,0,14"/>

                                <TextBlock Text="PDKS verilerinden hesaplanan fazla mesai, devamsızlık bilgileri ERP şablonuna aktarılacaktır."
                                           FontSize="15"
                                           FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                           Foreground="#424242"
                                           TextWrapping="Wrap"/>
                            </StackPanel>
                        </Border>

                        <Grid Grid.Row="2">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <!-- İşlem Butonları -->
                            <Grid Grid.Row="0" Margin="0,0,0,20">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="Auto"/>
                                </Grid.ColumnDefinitions>

                                <StackPanel Grid.Column="0"
                                            Orientation="Horizontal"
                                            VerticalAlignment="Center">
                                    <CheckBox x:Name="chkIncludePreviousMonthData"
                                              Content="Önceki ay tatil devrini dahil et"
                                              FontFamily="pack://application:,,,/Fonts/Poppins-Medium.ttf#Poppins"
                                              FontSize="14"
                                              VerticalAlignment="Center"
                                              Margin="0,0,12,0"
                                              Checked="chkIncludePreviousMonthData_Checked"
                                              Unchecked="chkIncludePreviousMonthData_Unchecked"/>
                                    <Border x:Name="PreviousMonthStatusBadge"
                                            Background="#FFF7ED"
                                            BorderBrush="#FED7AA"
                                            BorderThickness="1"
                                            CornerRadius="16"
                                            Padding="10,4"
                                            VerticalAlignment="Center">
                                        <TextBlock x:Name="txtPreviousMonthStatus"
                                                   Text="Geçmiş ay kontrol ediliyor..."
                                                   FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                                   FontSize="13"
                                                   Foreground="#9A3412"/>
                                    </Border>
                                </StackPanel>

                                <Button Grid.Column="1"
                                        x:Name="btnProcessData"
                                        Content="⚡ Verileri İşle ve Aktar"
                                        Style="{StaticResource WizardButton}"
                                        Background="#4CAF50"
                                        Click="btnProcessData_Click"/>
                            </Grid>

                            <!-- İşlem Sonuçları -->
                            <Border Grid.Row="1"
                                    x:Name="ProcessingResultsBorder"
                                    Visibility="Collapsed"
                                    Background="#F8FAFF"
                                    CornerRadius="14"
                                    Padding="24"
                                    Margin="0,0,0,20"
                                    BorderBrush="#E0E7FF"
                                    BorderThickness="1">
                                <StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                                        <Border Width="38"
                                                Height="38"
                                                CornerRadius="19"
                                                Background="#E0F2FE"
                                                HorizontalAlignment="Left">
                                            <TextBlock Text=""
                                                       FontFamily="Segoe MDL2 Assets"
                                                       FontSize="18"
                                                       Foreground="#0284C7"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"/>
                                        </Border>
                                        <StackPanel Margin="12,0,0,0">
                                            <TextBlock Text="İşlem Sonuçları"
                                                       FontSize="18"
                                                       FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins"
                                                       Foreground="#1E293B"/>
                                            <TextBlock x:Name="ProcessingResultsSubtitle"
                                                       Text="Veriler işleniyor..."
                                                       FontSize="13"
                                                       FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                                       Foreground="#64748B"
                                                       Margin="0,2,0,0"
                                                       TextWrapping="Wrap"/>
                                        </StackPanel>
                                    </StackPanel>

                                    <UniformGrid Columns="3" Margin="0,4,0,16">
                                        <Border Background="#EEF2FF"
                                                BorderBrush="#C7D2FE"
                                                BorderThickness="1"
                                                CornerRadius="12"
                                                Padding="16"
                                                Margin="0,0,12,0">
                                            <StackPanel>
                                                <TextBlock Text=""
                                                           FontFamily="Segoe MDL2 Assets"
                                                           FontSize="18"
                                                           Foreground="#4F46E5"
                                                           Margin="0,0,0,8"/>
                                                <TextBlock Text="Toplam PDKS Kaydı"
                                                           FontSize="12"
                                                           Foreground="#6366F1"
                                                           FontFamily="pack://application:,,,/Fonts/Poppins-Medium.ttf#Poppins"/>
                                                <TextBlock x:Name="TotalRecordsValueText"
                                                           Text="-"
                                                           FontSize="22"
                                                           FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins"
                                                           Foreground="#312E81"
                                                           Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Border>

                                        <Border Background="#ECFDF5"
                                                BorderBrush="#BBF7D0"
                                                BorderThickness="1"
                                                CornerRadius="12"
                                                Padding="16"
                                                Margin="0,0,12,0">
                                            <StackPanel>
                                                <TextBlock Text=""
                                                           FontFamily="Segoe MDL2 Assets"
                                                           FontSize="18"
                                                           Foreground="#16A34A"
                                                           Margin="0,0,0,8"/>
                                                <TextBlock Text="Eşleşen Personel"
                                                           FontSize="12"
                                                           Foreground="#16A34A"
                                                           FontFamily="pack://application:,,,/Fonts/Poppins-Medium.ttf#Poppins"/>
                                                <TextBlock x:Name="MatchedRecordsValueText"
                                                           Text="-"
                                                           FontSize="22"
                                                           FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins"
                                                           Foreground="#14532D"
                                                           Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Border>

                                        <Border Background="#FFF7ED"
                                                BorderBrush="#FED7AA"
                                                BorderThickness="1"
                                                CornerRadius="12"
                                                Padding="16">
                                            <StackPanel>
                                                <TextBlock Text=""
                                                           FontFamily="Segoe MDL2 Assets"
                                                           FontSize="18"
                                                           Foreground="#EA580C"
                                                           Margin="0,0,0,8"/>
                                                <TextBlock Text="İşlenen Kayıt"
                                                           FontSize="12"
                                                           Foreground="#EA580C"
                                                           FontFamily="pack://application:,,,/Fonts/Poppins-Medium.ttf#Poppins"/>
                                                <TextBlock x:Name="ProcessedRecordsValueText"
                                                           Text="-"
                                                           FontSize="22"
                                                           FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins"
                                                           Foreground="#7C2D12"
                                                           Margin="0,4,0,0"/>
                                            </StackPanel>
                                        </Border>
                                    </UniformGrid>

                                    <Border BorderBrush="#E2E8F0" BorderThickness="0,1,0,0" Margin="0,0,0,12"/>

                                    <StackPanel x:Name="ProcessingResultsStatusPanel"/>
                                </StackPanel>
                            </Border>

                            <!-- İlerleme Çubuğu -->
                            <Border Grid.Row="2"
                                    x:Name="ProgressBorder"
                                    Visibility="Collapsed"
                                    Background="#FFF3E0"
                                    CornerRadius="8"
                                    Padding="20"
                                    BorderBrush="#FF9800"
                                    BorderThickness="1">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>

                                    <TextBlock Grid.Row="0"
                                               x:Name="Step3ProgressText"
                                               Text="Veriler işleniyor..."
                                               FontSize="15"
                                               FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                               Foreground="#E65100"
                                               Margin="0,0,0,14"/>

                                    <ProgressBar Grid.Row="1"
                                                 x:Name="ProgressBar"
                                                 Height="20"
                                                 IsIndeterminate="True"/>
                                </Grid>
                            </Border>
                        </Grid>
                    </Grid>
                </Grid>
                <Grid x:Name="CarryOverContent" Visibility="Collapsed" Margin="0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <Grid Grid.Row="0" Margin="0,0,0,20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Geçmiş PDKS Verileri"
                                           FontSize="20"
                                           FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins"
                                           Foreground="#312E81"/>
                                <TextBlock x:Name="CarryOverSummaryText"
                                           Text="Önceki ay bilgileri yükleniyor..."
                                           FontSize="14"
                                           FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                           Foreground="#475569"
                                           Margin="0,6,0,0"/>
                            </StackPanel>
                            <Button Grid.Column="1"
                                    x:Name="btnManualAddCarryOver"
                                    Style="{StaticResource WizardButton}"
                                    Background="#4CAF50"
                                    Width="140"
                                    Height="40"
                                    Padding="12,8"
                                    Margin="0,0,10,0"
                                    Click="btnManualAddCarryOver_Click">
                                <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0"
                                               Text="➕"
                                               FontSize="18"
                                               Margin="0,0,8,0"
                                               VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1"
                                               Text="Kayıt Ekle"
                                               VerticalAlignment="Center"/>
                                </Grid>
                            </Button>
                            <Button Grid.Column="2"
                                    x:Name="btnBackFromCarryOver"
                                    Style="{StaticResource WizardButton}"
                                    Background="#1F2937"
                                    Width="140"
                                    Height="40"
                                    Click="btnBackFromCarryOver_Click">
                                <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="Auto"/>
                                    </Grid.ColumnDefinitions>
                                    <TextBlock Grid.Column="0"
                                               Text=""
                                               FontFamily="Segoe MDL2 Assets"
                                               FontSize="18"
                                               Margin="0,0,8,0"
                                               VerticalAlignment="Center"/>
                                    <TextBlock Grid.Column="1"
                                               Text="Geri Dön"
                                               VerticalAlignment="Center"/>
                                </Grid>
                            </Button>
                        </Grid>

                        <Border Grid.Row="1"
                                Background="#F8FAFF"
                                CornerRadius="16"
                                Padding="20"
                                BorderBrush="#E0E7FF"
                                BorderThickness="1"
                                VerticalAlignment="Stretch">
                            <Grid VerticalAlignment="Stretch">
                                <Grid.RowDefinitions>
                                    <RowDefinition Height="Auto"/>
                                    <RowDefinition Height="*"/>
                                </Grid.RowDefinitions>
                                
                                <Border Grid.Row="0"
                                        Background="#FFFFFF"
                                        BorderBrush="#E2E8F0"
                                        BorderThickness="1"
                                        CornerRadius="12"
                                        Margin="0,0,0,16">
                                    <Expander x:Name="CarryOverFilterExpander"
                                              IsExpanded="False"
                                              Background="Transparent"
                                              BorderThickness="0"
                                              Padding="0">
                                        <Expander.Style>
                                            <Style TargetType="Expander">
                                                <Setter Property="Template">
                                                    <Setter.Value>
                                                        <ControlTemplate TargetType="Expander">
                                                            <Grid>
                                                                <Grid.RowDefinitions>
                                                                    <RowDefinition Height="Auto"/>
                                                                    <RowDefinition Height="*"/>
                                                                </Grid.RowDefinitions>
                                                                <ToggleButton x:Name="HeaderSite"
                                                                              Grid.Row="0"
                                                                              Content="{TemplateBinding Header}"
                                                                              ContentTemplate="{TemplateBinding HeaderTemplate}"
                                                                              ContentTemplateSelector="{TemplateBinding HeaderTemplateSelector}"
                                                                              IsChecked="{Binding Path=IsExpanded, Mode=TwoWay, RelativeSource={RelativeSource TemplatedParent}}"
                                                                              Background="Transparent"
                                                                              BorderThickness="0"
                                                                              Padding="0"
                                                                              Margin="0"
                                                                              Focusable="False"/>
                                                                <ContentPresenter x:Name="ExpandSite"
                                                                                  Grid.Row="1"
                                                                                  Visibility="Collapsed"
                                                                                  HorizontalAlignment="{TemplateBinding HorizontalContentAlignment}"
                                                                                  Margin="{TemplateBinding Padding}"/>
                                                            </Grid>
                                                            <ControlTemplate.Triggers>
                                                                <Trigger Property="IsExpanded" Value="True">
                                                                    <Setter TargetName="ExpandSite" Property="Visibility" Value="Visible"/>
                                                                </Trigger>
                                                            </ControlTemplate.Triggers>
                                                        </ControlTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </Style>
                                        </Expander.Style>
                                        <Expander.Header>
                                            <Grid Margin="16,12,16,12">
                                                <Grid.ColumnDefinitions>
                                                    <ColumnDefinition Width="*"/>
                                                    <ColumnDefinition Width="Auto"/>
                                                </Grid.ColumnDefinitions>
                                                <TextBlock Grid.Column="0"
                                                           Text="Filtreler"
                                                           FontSize="14"
                                                           FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins"
                                                           Foreground="#0F172A"
                                                           VerticalAlignment="Center"
                                                           HorizontalAlignment="Left"/>
                                                <Path Grid.Column="1"
                                                      x:Name="ExpandIcon"
                                                      Data="M 0 0 L 4 4 L 8 0 Z"
                                                      Fill="#64748B"
                                                      Stretch="Uniform"
                                                      Width="12"
                                                      Height="12"
                                                      VerticalAlignment="Center"
                                                      HorizontalAlignment="Right"
                                                      Margin="8,0,0,0">
                                                    <Path.Style>
                                                        <Style TargetType="Path">
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding IsExpanded, RelativeSource={RelativeSource AncestorType=Expander}}" Value="True">
                                                                    <Setter Property="RenderTransform">
                                                                        <Setter.Value>
                                                                            <RotateTransform Angle="180"/>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </Path.Style>
                                                </Path>
                                            </Grid>
                                        </Expander.Header>
                                        <Border Padding="16,0,16,16">
                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="Auto"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <!-- Personel Arama -->
                                            <StackPanel Grid.Column="0" Margin="0,0,8,0">
                                                <TextBlock Text="Personel Arama"
                                                           FontSize="12"
                                                           Foreground="#475569"/>
                                                <TextBox x:Name="CarryOverPersonFilterBox"
                                                         Margin="0,4,0,0"
                                                         Padding="2,1"
                                                         Height="32"
                                                         FontSize="13"
                                                         Background="#F8FAFC"
                                                         BorderBrush="#CBD5E1"
                                                         BorderThickness="1"
                                                         TextChanged="CarryOverPersonFilterBox_TextChanged">
                                                    <TextBox.Style>
                                                        <Style TargetType="TextBox">
                                                            <Setter Property="Template">
                                                                <Setter.Value>
                                                                    <ControlTemplate TargetType="TextBox">
                                                                        <Border Background="{TemplateBinding Background}"
                                                                                BorderBrush="{TemplateBinding BorderBrush}"
                                                                                BorderThickness="{TemplateBinding BorderThickness}"
                                                                                CornerRadius="6">
                                                                            <ScrollViewer x:Name="PART_ContentHost" Margin="{TemplateBinding Padding}"/>
                                                                        </Border>
                                                                    </ControlTemplate>
                                                                </Setter.Value>
                                                            </Setter>
                                                        </Style>
                                                    </TextBox.Style>
                                                </TextBox>
                                            </StackPanel>
                                            
                                            <!-- Vardiya -->
                                            <StackPanel Grid.Column="1" Margin="0,0,8,0">
                                                <TextBlock Text="Vardiya"
                                                           FontSize="12"
                                                           Foreground="#475569"/>
                                                <ComboBox x:Name="CarryOverShiftCombo"
                                                          Margin="0,4,0,0"
                                                          Height="32"
                                                          FontSize="13"
                                                          SelectionChanged="CarryOverShiftCombo_SelectionChanged"/>
                                            </StackPanel>

                                            <!-- Tarih Aralığı -->
                                            <StackPanel Grid.Column="2" Margin="0,0,8,0">
                                                <TextBlock Text="Tarih Aralığı"
                                                           FontSize="12"
                                                           Foreground="#475569"/>
                                                <Grid Margin="0,4,0,0">
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="*"/>
                                                        <ColumnDefinition Width="Auto"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>
                                                    <DatePicker Grid.Column="0"
                                                               x:Name="CarryOverMinDatePicker"
                                                               Height="32"
                                                               FontSize="12"
                                                               Margin="0,0,4,0"
                                                               SelectedDateChanged="CarryOverMinDatePicker_SelectedDateChanged"/>
                                                    <TextBlock Grid.Column="1"
                                                               Text="-" 
                                                               VerticalAlignment="Center" 
                                                               Foreground="#475569" 
                                                               Margin="0,0,4,0" 
                                                               FontSize="14"/>
                                                    <DatePicker Grid.Column="2"
                                                               x:Name="CarryOverMaxDatePicker"
                                                               Height="32"
                                                               FontSize="12"
                                                               SelectedDateChanged="CarryOverMaxDatePicker_SelectedDateChanged"/>
                                                </Grid>
                                            </StackPanel>

                                            <!-- Filtreleri Temizle Butonu -->
                                            <Button Grid.Column="3"
                                                    x:Name="btnClearCarryOverFilters"
                                                    Content="Temizle"
                                                    Style="{StaticResource WizardButton}"
                                                    Background="#475569"
                                                    Padding="12,6"
                                                    Height="32"
                                                    VerticalAlignment="Bottom"
                                                    Margin="0,0,0,0"
                                                    Click="btnClearCarryOverFilters_Click"/>
                                        </Grid>
                                        </Border>
                                    </Expander>
                                </Border>

                                <Grid Grid.Row="1" Margin="0,0,0,12">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>
                                    <Grid Grid.Row="0" Margin="0,0,0,8">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <TextBlock Grid.Column="0"
                                                   x:Name="CarryOverFilterResultText"
                                                   Text="0 kayıt gösteriliyor"
                                                   FontSize="13"
                                                   Foreground="#475569"
                                                   VerticalAlignment="Center"/>
                                        <StackPanel Grid.Column="1"
                                                   Orientation="Horizontal"
                                                   Margin="12,0,0,0">
                                            <Button x:Name="btnSelectAllCarryOver"
                                                    Style="{StaticResource WizardButton}"
                                                    Background="#2196F3"
                                                    Padding="8"
                                                    Width="36"
                                                    Height="36"
                                                    ToolTip="Tümünü Seç"
                                                    Click="btnSelectAllCarryOver_Click">
                                                <TextBlock Text="&#xE73E;"
                                                           FontFamily="Segoe MDL2 Assets"
                                                           FontSize="18"
                                                           Foreground="White"
                                                           VerticalAlignment="Center"
                                                           HorizontalAlignment="Center"/>
                                            </Button>
                                            <Button x:Name="btnDeleteSelectedCarryOver"
                                                    Style="{StaticResource WizardButton}"
                                                    Background="#F44336"
                                                    Padding="8"
                                                    Width="36"
                                                    Height="36"
                                                    Margin="8,0,0,0"
                                                    ToolTip="Seçilenleri Sil"
                                                    Click="btnDeleteSelectedCarryOver_Click">
                                                <TextBlock Text="&#xE74D;"
                                                           FontFamily="Segoe MDL2 Assets"
                                                           FontSize="18"
                                                           Foreground="White"
                                                           VerticalAlignment="Center"
                                                           HorizontalAlignment="Center"/>
                                            </Button>
                                        </StackPanel>
                                    </Grid>
                                    <Border Grid.Row="1"
                                            BorderBrush="#E2E8F0"
                                            BorderThickness="1"
                                            CornerRadius="8"
                                            Background="White"
                                            VerticalAlignment="Stretch">
                                        <Grid>
                                            <ListView x:Name="CarryOverListView"
                                                      Margin="0"
                                                      Visibility="Collapsed"
                                                      BorderThickness="0"
                                                      Background="Transparent"
                                                      ScrollViewer.VerticalScrollBarVisibility="Auto"
                                                      ScrollViewer.HorizontalScrollBarVisibility="Auto"
                                                      VerticalAlignment="Stretch">
                                                <ListView.View>
                                                    <GridView AllowsColumnReorder="False">
                                                        <GridViewColumn Header="Seç"
                                                                        Width="50">
                                                            <GridViewColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"/>
                                                                </DataTemplate>
                                                            </GridViewColumn.CellTemplate>
                                                        </GridViewColumn>
                                                        <GridViewColumn Header="Sicil"
                                                                        Width="100"
                                                                        DisplayMemberBinding="{Binding PersonnelCode}"/>
                                                        <GridViewColumn Header="Personel"
                                                                        Width="200"
                                                                        DisplayMemberBinding="{Binding PersonnelName}"/>
                                                        <GridViewColumn Header="Tarih"
                                                                        Width="110"
                                                                        DisplayMemberBinding="{Binding Date, StringFormat='{}{0:dd.MM.yyyy}'}"/>
                                                        <GridViewColumn Header="Giriş"
                                                                        Width="80"
                                                                        DisplayMemberBinding="{Binding CheckInTime, StringFormat='{}{0:hh\\:mm}'}"/>
                                                        <GridViewColumn Header="Çıkış"
                                                                        Width="80"
                                                                        DisplayMemberBinding="{Binding CheckOutTime, StringFormat='{}{0:hh\\:mm}'}"/>
                                                        <GridViewColumn Header="Vardiya"
                                                                        Width="120"
                                                                        DisplayMemberBinding="{Binding ShiftType}"/>
                                                    </GridView>
                                                </ListView.View>
                                            </ListView>
                                            
                                            <StackPanel x:Name="CarryOverEmptyText"
                                                       Orientation="Horizontal"
                                                       HorizontalAlignment="Center"
                                                       VerticalAlignment="Center"
                                                       Margin="0,40,0,40"
                                                       Visibility="Collapsed">
                                                <TextBlock Text="📭"
                                                           FontSize="48"
                                                           Margin="0,0,16,0"
                                                           VerticalAlignment="Center"/>
                                                <StackPanel VerticalAlignment="Center">
                                                    <TextBlock Text="Henüz Veri Yok"
                                                               FontSize="18"
                                                               FontFamily="pack://application:,,,/Fonts/Poppins-SemiBold.ttf#Poppins"
                                                               Foreground="#475569"
                                                               Margin="0,0,0,8"/>
                                                    <TextBlock Text="Bu firma için kayıtlı PDKS verisi bulunamadı. Excel'den içe aktarabilir veya manuel olarak ekleyebilirsiniz."
                                                               FontSize="14"
                                                               FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                                               Foreground="#64748B"
                                                               TextWrapping="Wrap"
                                                               MaxWidth="400"/>
                                                </StackPanel>
                                            </StackPanel>
                                        </Grid>
                                    </Border>
                                </Grid>
                            </Grid>
                        </Border>
                    </Grid>
                </Grid>
            </Border>
        </Grid>

        <!-- Footer - Navigation Buttons -->
        <Border Grid.Row="2" Background="White" Padding="20" BorderBrush="#E0E0E0" BorderThickness="0,1,0,0">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Progress Info -->
                <TextBlock x:Name="ProgressText"
                           Text="Adım 1 / 4"
                           VerticalAlignment="Center"
                           FontSize="15"
                           Foreground="#666"/>

                <!-- Previous Button -->
                <Button Grid.Column="1"
                        x:Name="btnPrevious"
                        Content="⬅️ Geri"
                        Style="{StaticResource WizardButton}"
                        Background="#757575"
                        IsEnabled="False"
                        Margin="0,0,10,0"
                        Click="btnPrevious_Click"/>

                <!-- Next Button -->
                <Button Grid.Column="2"
                        x:Name="btnNext"
                        Content="İleri ➡️"
                        Style="{StaticResource WizardButton}"
                        Click="btnNext_Click"/>
            </Grid>
        </Border>
    </Grid>
</Window>
