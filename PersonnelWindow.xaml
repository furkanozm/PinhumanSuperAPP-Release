<Window x:Class="WebScraper.PersonnelWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="👥 Personel İşlemleri - Güleryüz Group"
        WindowState="Maximized"
        WindowStartupLocation="CenterScreen"
        MinHeight="600" MinWidth="800"
        FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins">

    <Window.Resources>
        <!-- Modern UI Styles -->
        <Style x:Key="ModernButton" TargetType="Button">
            <Setter Property="Background" Value="#FF9800"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="FontFamily" Value="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Height" Value="38"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="HorizontalContentAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Border"
                                Background="{TemplateBinding Background}"
                                CornerRadius="8"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter x:Name="ContentPresenter"
                                            HorizontalAlignment="Center"
                                            VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Border" Property="Background" Value="#CCCCCC"/>
                                <Setter TargetName="ContentPresenter" Property="Opacity" Value="0.5"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#E65100"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- PasswordBox için modern stil -->
        <Style x:Key="ModernPasswordBox" TargetType="PasswordBox">
            <Setter Property="Padding" Value="0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontFamily" Value="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="PasswordBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8">
                            <ScrollViewer Margin="10,8" VerticalAlignment="Center">
                                <ScrollViewer x:Name="PART_ContentHost"/>
                            </ScrollViewer>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Label için modern stil -->
        <Style x:Key="ModernLabel" TargetType="Label">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontFamily" Value="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <Style x:Key="ModernTextBox" TargetType="TextBox">
            <Setter Property="Padding" Value="0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="Background" Value="White"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontFamily" Value="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TextBox">
                        <Border Background="{TemplateBinding Background}"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                CornerRadius="8">
                            <ScrollViewer x:Name="PART_ContentHost"
                                          Margin="10,8"
                                          VerticalAlignment="Center"/>
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <Style x:Key="CardBorder" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#E0E0E0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Effect">
                <Setter.Value>
                    <DropShadowEffect Color="LightGray" Direction="270" ShadowDepth="3" Opacity="0.2"/>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Modern TabItem Style -->
        <Style x:Key="ModernTabItem" TargetType="TabItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,20"/>
            <Setter Property="Margin" Value="0,0,5,0"/>
            <Setter Property="MinWidth" Value="140"/>
            <Setter Property="MinHeight" Value="50"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="Normal"/>
            <Setter Property="Foreground" Value="#666666"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabItem">
                        <Grid>
                            <Border x:Name="Border"
                                    Background="Transparent"
                                    BorderThickness="0,0,0,3"
                                    BorderBrush="Transparent"
                                    CornerRadius="8,8,0,0">
                                <ContentPresenter x:Name="ContentSite"
                                                ContentSource="Header"
                                                HorizontalAlignment="Center"
                                                VerticalAlignment="Center"
                                                Margin="0,8"/>
                            </Border>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#F0F8FF"/>
                                <Setter TargetName="Border" Property="BorderBrush" Value="#2196F3"/>
                                <Setter Property="Foreground" Value="#2196F3"/>
                            </Trigger>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Border" Property="Background" Value="#F5F5F5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Emoji TabItem Style - Renkli emoji'li tab'lar için -->
        <Style x:Key="EmojiTabItem" TargetType="TabItem" BasedOn="{StaticResource ModernTabItem}">
            <Setter Property="FontFamily" Value="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"/>
            <Setter Property="TextOptions.TextFormattingMode" Value="Display"/>
            <Setter Property="TextOptions.TextRenderingMode" Value="ClearType"/>
        </Style>

        <!-- Modern TabControl Style -->
        <Style x:Key="ModernTabControl" TargetType="TabControl">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="TabControl">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="*"/>
                            </Grid.RowDefinitions>

                            <!-- Tab Headers -->
                            <Border Grid.Row="0"
                                    Background="White"
                                    BorderBrush="#E0E0E0"
                                    BorderThickness="0,0,0,1"
                                    Padding="20,0">
                                <TabPanel x:Name="HeaderPanel"
                                         IsItemsHost="true"
                                         KeyboardNavigation.TabIndex="1"/>
                            </Border>

                            <!-- Tab Content -->
                            <Border Grid.Row="1"
                                    Background="White"
                                    BorderBrush="#E0E0E0"
                                    BorderThickness="0,0,0,1">
                                <ContentPresenter x:Name="PART_SelectedContentHost"
                                                ContentSource="SelectedContent"/>
                            </Border>
                        </Grid>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <!-- Ana Panel -->
        <Grid x:Name="MainPanel" Visibility="Visible">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" Background="#E8EAF6" Padding="15,10" Height="100">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Logo -->
                    <Border Grid.Column="0"
                            Width="80"
                            Height="80"
                            Margin="10,0,20,0"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Left">
                        <Border.RenderTransform>
                            <RotateTransform x:Name="LogoRotation" CenterX="40" CenterY="40"/>
                        </Border.RenderTransform>
                        <Border.Triggers>
                            <EventTrigger RoutedEvent="Border.Loaded">
                                <BeginStoryboard>
                                    <Storyboard RepeatBehavior="Forever">
                                        <DoubleAnimation
                                            Storyboard.TargetName="LogoRotation"
                                            Storyboard.TargetProperty="Angle"
                                            From="0" To="360" Duration="0:0:3"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </Border.Triggers>
                        <Image Source="pack://application:,,,/sadece logo.png"
                               Width="80"
                               Height="80"
                               Stretch="Uniform"
                               HorizontalAlignment="Center"
                               VerticalAlignment="Center"/>
                    </Border>

                    <!-- Title -->
                    <StackPanel Grid.Column="1" VerticalAlignment="Center" Margin="0,0,0,0">
                        <TextBlock Text="Personel İşlemleri"
                                   FontSize="26"
                                   FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                   Foreground="Black"/>
                        <TextBlock Text="Güleryüz Group"
                                   FontSize="16"
                                   FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                   Foreground="#333333"
                                   Margin="0,2,0,0"/>
                    </StackPanel>

                    <!-- Buttons -->
                    <StackPanel Grid.Column="2" Orientation="Horizontal" HorizontalAlignment="Right">
                        <!-- Geri butonu kaldırıldı -->
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Tab Control -->
            <TabControl x:Name="MainTab" Grid.Row="1" Margin="20" Style="{StaticResource ModernTabControl}" SelectionChanged="MainTab_SelectionChanged">
                <!-- Ana İşlemler Tab -->
                <TabItem Style="{StaticResource EmojiTabItem}">
                    <TabItem.Header>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Path Data="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z M9 22v-9a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v9"
                                  Fill="#FF9800"
                                  Width="16"
                                  Height="16"
                                  Margin="0,0,8,0"
                                  Stretch="Uniform"/>
                            <TextBlock Text="Ana İşlemler" VerticalAlignment="Center"/>
                        </StackPanel>
                    </TabItem.Header>
                    <Grid Margin="20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Başlık -->
                        <TextBlock Grid.Row="0"
                                  Text="Personel işlemleri türünü seçiniz"
                                  FontSize="24"
                                  FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                  FontWeight="Normal"
                                  HorizontalAlignment="Center"
                                  Margin="0,0,0,30"
                                  Foreground="#333"/>

                        <!-- İşlem Kartları -->
                        <Grid Grid.Row="1">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="40"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Personel Ekle Kartı -->
                            <Border Grid.Column="0"
                                    BorderBrush="#FFB74D"
                                    BorderThickness="2"
                                    Style="{StaticResource CardBorder}"
                                    Padding="40"
                                    Margin="20"
                                    Cursor="Hand"
                                    MouseLeftButtonDown="PersonnelAddCard_Click"
                                    RenderTransformOrigin="0.5,0.5">
                                <Border.RenderTransform>
                                    <ScaleTransform/>
                                </Border.RenderTransform>
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                        <GradientStop Color="#FFF8E1" Offset="0"/>
                                        <GradientStop Color="#FFECB3" Offset="0.3"/>
                                        <GradientStop Color="#FFD54F" Offset="0.7"/>
                                        <GradientStop Color="#FFB74D" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <Border.Effect>
                                    <DropShadowEffect Color="#FF9800" Direction="270" ShadowDepth="8" Opacity="0.15" BlurRadius="15"/>
                                </Border.Effect>
                                <Border.Triggers>
                                    <EventTrigger RoutedEvent="Border.MouseEnter">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation
                                                    Storyboard.TargetProperty="(Border.Effect).(DropShadowEffect.ShadowDepth)"
                                                    To="15"
                                                    Duration="0:0:0.2"/>
                                                <DoubleAnimation
                                                    Storyboard.TargetProperty="(Border.Effect).(DropShadowEffect.Opacity)"
                                                    To="0.25"
                                                    Duration="0:0:0.2"/>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Border.Background).(LinearGradientBrush.GradientStops)[3].(GradientStop.Color)"
                                                    To="#FF8F00"
                                                    Duration="0:0:0.2"/>
                                                <DoubleAnimation
                                                    Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleX)"
                                                    To="0.98"
                                                    Duration="0:0:0.1"/>
                                                <DoubleAnimation
                                                    Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleY)"
                                                    To="0.98"
                                                    Duration="0:0:0.1"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                    <EventTrigger RoutedEvent="Border.MouseLeave">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation
                                                    Storyboard.TargetProperty="(Border.Effect).(DropShadowEffect.ShadowDepth)"
                                                    To="8"
                                                    Duration="0:0:0.2"/>
                                                <DoubleAnimation
                                                    Storyboard.TargetProperty="(Border.Effect).(DropShadowEffect.Opacity)"
                                                    To="0.15"
                                                    Duration="0:0:0.2"/>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Border.Background).(LinearGradientBrush.GradientStops)[3].(GradientStop.Color)"
                                                    To="#FFB74D"
                                                    Duration="0:0:0.2"/>
                                                <DoubleAnimation
                                                    Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleX)"
                                                    To="1.0"
                                                    Duration="0:0:0.2"/>
                                                <DoubleAnimation
                                                    Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleY)"
                                                    To="1.0"
                                                    Duration="0:0:0.2"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </Border.Triggers>
                                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                    <TextBlock Text="👤"
                                              FontSize="80"
                                              HorizontalAlignment="Center"
                                              Margin="0,0,0,20"
                                              Foreground="#FF9800"/>
                                    <TextBlock Text="İşçi Ekle"
                                              FontSize="24"
                                              FontFamily="pack://application:,,,/Fonts/Poppins-Bold.ttf#Poppins"
                                              FontWeight="Bold"
                                              HorizontalAlignment="Center"
                                              Foreground="#E65100"
                                              Margin="0,0,0,15"
                                              TextWrapping="Wrap"
                                              TextAlignment="Center"/>
                                    <TextBlock Text="Yeni personel kaydı oluşturun ve işe giriş işlemlerini tamamlayın"
                                              FontSize="16"
                                              FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                              TextWrapping="Wrap"
                                              TextAlignment="Center"
                                              Foreground="#424242"
                                              LineHeight="22"/>
                                </StackPanel>
                            </Border>

                            <!-- İşe Giriş Yap Kartı -->
                            <Border Grid.Column="2"
                                    BorderBrush="#4CAF50"
                                    BorderThickness="2"
                                    Style="{StaticResource CardBorder}"
                                    Padding="40"
                                    Margin="20"
                                    Cursor="Hand"
                                    MouseLeftButtonDown="JobEntryCard_Click"
                                    RenderTransformOrigin="0.5,0.5">
                                <Border.RenderTransform>
                                    <ScaleTransform/>
                                </Border.RenderTransform>
                                <Border.Background>
                                    <LinearGradientBrush StartPoint="0,0" EndPoint="1,1">
                                        <GradientStop Color="#E8F5E8" Offset="0"/>
                                        <GradientStop Color="#C8E6C9" Offset="0.3"/>
                                        <GradientStop Color="#81C784" Offset="0.7"/>
                                        <GradientStop Color="#4CAF50" Offset="1"/>
                                    </LinearGradientBrush>
                                </Border.Background>
                                <Border.Effect>
                                    <DropShadowEffect Color="#4CAF50" Direction="270" ShadowDepth="8" Opacity="0.15" BlurRadius="15"/>
                                </Border.Effect>
                                <Border.Triggers>
                                    <EventTrigger RoutedEvent="Border.MouseEnter">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation
                                                    Storyboard.TargetProperty="(Border.Effect).(DropShadowEffect.ShadowDepth)"
                                                    To="15"
                                                    Duration="0:0:0.2"/>
                                                <DoubleAnimation
                                                    Storyboard.TargetProperty="(Border.Effect).(DropShadowEffect.Opacity)"
                                                    To="0.25"
                                                    Duration="0:0:0.2"/>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Border.Background).(LinearGradientBrush.GradientStops)[3].(GradientStop.Color)"
                                                    To="#2E7D32"
                                                    Duration="0:0:0.2"/>
                                                <DoubleAnimation
                                                    Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleX)"
                                                    To="0.98"
                                                    Duration="0:0:0.1"/>
                                                <DoubleAnimation
                                                    Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleY)"
                                                    To="0.98"
                                                    Duration="0:0:0.1"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                    <EventTrigger RoutedEvent="Border.MouseLeave">
                                        <BeginStoryboard>
                                            <Storyboard>
                                                <DoubleAnimation
                                                    Storyboard.TargetProperty="(Border.Effect).(DropShadowEffect.ShadowDepth)"
                                                    To="8"
                                                    Duration="0:0:0.2"/>
                                                <DoubleAnimation
                                                    Storyboard.TargetProperty="(Border.Effect).(DropShadowEffect.Opacity)"
                                                    To="0.15"
                                                    Duration="0:0:0.2"/>
                                                <ColorAnimation
                                                    Storyboard.TargetProperty="(Border.Background).(LinearGradientBrush.GradientStops)[3].(GradientStop.Color)"
                                                    To="#4CAF50"
                                                    Duration="0:0:0.2"/>
                                                <DoubleAnimation
                                                    Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleX)"
                                                    To="1.0"
                                                    Duration="0:0:0.2"/>
                                                <DoubleAnimation
                                                    Storyboard.TargetProperty="(Border.RenderTransform).(ScaleTransform.ScaleY)"
                                                    To="1.0"
                                                    Duration="0:0:0.2"/>
                                            </Storyboard>
                                        </BeginStoryboard>
                                    </EventTrigger>
                                </Border.Triggers>
                                <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center">
                                    <TextBlock Text="💼"
                                              FontSize="80"
                                              HorizontalAlignment="Center"
                                              Margin="0,0,0,20"
                                              Foreground="#4CAF50"/>
                                    <TextBlock Text="Sözleşmeli Personel Ekle"
                                              FontSize="24"
                                              FontFamily="pack://application:,,,/Fonts/Poppins-Bold.ttf#Poppins"
                                              FontWeight="Bold"
                                              HorizontalAlignment="Center"
                                              Foreground="#2E7D32"
                                              Margin="0,0,0,15"
                                              TextWrapping="Wrap"
                                              TextAlignment="Center"/>
                                    <TextBlock Text="Sözleşmeli personel kayıt işlemlerini yönetin"
                                              FontSize="16"
                                              FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                              TextWrapping="Wrap"
                                              TextAlignment="Center"
                                              Foreground="#424242"
                                              LineHeight="22"/>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </Grid>
                </TabItem>

                <!-- Personel Ekle Tab -->
                <TabItem Style="{StaticResource EmojiTabItem}">
                    <TabItem.Header>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Path Data="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2 M12 11a4 4 0 1 0 0-8 4 4 0 0 0 0 8z"
                                  Fill="#4CAF50"
                                  Width="16"
                                  Height="16"
                                  Margin="0,0,8,0"
                                  Stretch="Uniform"/>
                            <TextBlock Text="İşçi Ekle" VerticalAlignment="Center"/>
                        </StackPanel>
                    </TabItem.Header>
                    <Grid Margin="20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Başlık -->
                        <StackPanel Grid.Row="0" Margin="0,0,0,20">
                            <TextBlock x:Name="PersonnelAddTitle"
                                       Text="👤 Personel Ekle"
                                       FontSize="24"
                                       FontFamily="pack://application:,,,/Fonts/Poppins-Bold.ttf#Poppins"
                                       FontWeight="Bold"
                                       HorizontalAlignment="Center"
                                       Foreground="#333"/>
                            <TextBlock x:Name="PersonnelAddSubtitle"
                                       Text="Yeni personel bilgilerini girin ve işlemi başlatın"
                                       FontSize="14"
                                       FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                       HorizontalAlignment="Center"
                                       Foreground="#666"
                                       Margin="0,5,0,0"/>
                        </StackPanel>

                        <!-- Ana İçerik -->
                        <Grid Grid.Row="1" Margin="0,0,0,20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <!-- Log Alanı - Tam Genişlik -->
                            <Border Grid.Column="0"
                                    Style="{StaticResource CardBorder}"
                                    Padding="20"
                                    Margin="0,0,0,0">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                    </Grid.RowDefinitions>

                                    <!-- Log Başlığı ve Butonları Aynı Satırda -->
                                    <Grid Grid.Row="0" Margin="0,0,0,15">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- Log Başlığı -->
                                        <TextBlock Grid.Column="0"
                                                   Text="📋 İşlem Logları"
                                                   FontSize="18"
                                                   FontFamily="pack://application:,,,/Fonts/Poppins-Bold.ttf#Poppins"
                                                   FontWeight="Bold"
                                                   Foreground="#333"
                                                   VerticalAlignment="Center"/>

                                        <!-- Log Butonları -->
                                        <StackPanel Grid.Column="1"
                                                    Orientation="Horizontal">
                                            <Button x:Name="btnClearLogs"
                                                    Content="🗑️ Temizle"
                                                    Style="{StaticResource ModernButton}"
                                                    Background="#FF9800"
                                                    Foreground="White"
                                                    Margin="0,0,8,0"
                                                    Padding="12,8"
                                                    Click="btnClearLogs_Click"/>
                                            <Button x:Name="btnCopyLogs"
                                                    Content="📋 Kopyala"
                                                    Style="{StaticResource ModernButton}"
                                                    Background="#2196F3"
                                                    Foreground="White"
                                                    Margin="0,0,8,0"
                                                    Padding="12,8"
                                                    Click="btnCopyLogs_Click"/>
                                            <Button x:Name="btnSaveLogs"
                                                    Content="💾 Kaydet"
                                                    Style="{StaticResource ModernButton}"
                                                    Background="#4CAF50"
                                                    Foreground="White"
                                                    Margin="0,0,0,0"
                                                    Padding="12,8"
                                                    Click="btnSaveLogs_Click"/>
                                        </StackPanel>
                                    </Grid>

                                    <!-- Log TextBox - Yüksekliği Artırıldı -->
                                    <TextBox x:Name="LogTextBox"
                                             Grid.Row="1"
                                             Background="Black"
                                             Foreground="White"
                                             FontFamily="Consolas"
                                             FontSize="11"
                                             IsReadOnly="True"
                                             VerticalScrollBarVisibility="Auto"
                                             HorizontalScrollBarVisibility="Auto"
                                             TextWrapping="Wrap"
                                             AcceptsReturn="True"
                                             MinHeight="300"/>
                                </Grid>
                            </Border>
                        </Grid>

                        <!-- Alt Bilgilendirme -->
                        <Border Grid.Row="2"
                                Background="#FFF3E0"
                                BorderBrush="#FF9800"
                                BorderThickness="1"
                                CornerRadius="8"
                                Padding="15">
                            <StackPanel>
                                <TextBlock Text="ℹ️ Kullanım Kılavuzu"
                                           FontSize="16"
                                           FontWeight="Bold"
                                           Foreground="#E65100"
                                           Margin="0,0,0,10"/>
                                <TextBlock Text="• Excel dosyasından çoklu personel ekleme yapmak için önce şablon indirin"
                                           FontSize="13"
                                           Foreground="#333"
                                           Margin="0,0,0,5"/>
                                <TextBlock Text="• Manuel giriş için form alanlarını doldurun"
                                           FontSize="13"
                                           Foreground="#333"
                                           Margin="0,0,0,5"/>
                                <TextBlock Text="• Log alanında tüm işlem detaylarını görebilirsiniz"
                                           FontSize="13"
                                           Foreground="#333"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </TabItem>

                <!-- Geçmiş Tab -->
                <TabItem Style="{StaticResource EmojiTabItem}">
                    <TabItem.Header>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Path Data="M3 12a9 9 0 1 0 18 0 9 9 0 0 0-18 0z M12 7v5l3 2 M12 1v3 M12 21v3"
                                  Fill="#9C27B0"
                                  Width="16"
                                  Height="16"
                                  Margin="0,0,8,0"
                                  Stretch="Uniform"/>
                            <TextBlock Text="Geçmiş" VerticalAlignment="Center"/>
                        </StackPanel>
                    </TabItem.Header>
                    <Grid Margin="20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <!-- Başlık -->
                        <StackPanel Grid.Column="0" Grid.ColumnSpan="2" Grid.Row="0" Margin="0,0,0,20">
                            <TextBlock Text="📋 Personel Geçmişi"
                                     FontSize="24"
                                     FontFamily="pack://application:,,,/Fonts/Poppins-Bold.ttf#Poppins"
                                     FontWeight="Bold"
                                     HorizontalAlignment="Center"
                                     Foreground="#333"/>
                            <TextBlock Text="Kayıt edilen personellerin geçmişini görüntüleyin"
                                     FontSize="14"
                                     FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                     HorizontalAlignment="Center"
                                     Foreground="#666"
                                     Margin="0,5,0,0"/>
                        </StackPanel>

                        <!-- Filter Alanları ve Butonlar -->
                        <Border Grid.Column="0" Grid.ColumnSpan="2" Grid.Row="1"
                                Background="#F8F9FA"
                                BorderBrush="#E0E0E0"
                                BorderThickness="1"
                                CornerRadius="8"
                                Margin="0,0,0,20"
                                Padding="15">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="180"/>
                                    <ColumnDefinition Width="20"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="160"/>
                                    <ColumnDefinition Width="20"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="Auto"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <!-- TCKN Filter -->
                                <TextBlock Grid.Column="0"
                                         Text="TCKN Ara:"
                                         FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                         FontSize="13"
                                         VerticalAlignment="Center"
                                         Foreground="#333"/>
                                <TextBox x:Name="txtHistoryTcknFilter"
                                        Grid.Column="1"
                                        Height="32"
                                        Padding="8,0,0,0"
                                        FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                        FontSize="12"
                                        TextChanged="txtHistoryTcknFilter_TextChanged"/>

                                <!-- Personel Tipi Filter -->
                                <TextBlock Grid.Column="3"
                                         Text="Personel Tipi:"
                                         FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                         FontSize="13"
                                         VerticalAlignment="Center"
                                         Foreground="#333"/>
                                    <ComboBox x:Name="cmbHistoryPersonelTipiFilter"
                                         Grid.Column="4"
                                         Height="32"
                                         FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                         FontSize="12"
                                         SelectionChanged="cmbHistoryPersonelTipiFilter_SelectionChanged">
                                    <ComboBoxItem Content="Tümü" IsSelected="True"/>
                                    <ComboBoxItem Content="İşçi"/>
                                    <ComboBoxItem Content="Sözleşmeli Pers."/>
                                </ComboBox>

                                <!-- Temizle Butonu -->
                                <Button x:Name="btnClearHistoryFilters"
                                       Grid.Column="6"
                                       Content="🔄 Temizle"
                                       Style="{StaticResource ModernButton}"
                                       Background="#FF9800"
                                       Foreground="White"
                                       Height="32"
                                       Padding="12,0"
                                       Click="btnClearHistoryFilters_Click"
                                       Margin="0,0,10,0"/>

                                <!-- Sağ Butonlar -->
                                <Button x:Name="btnRefreshHistory"
                                        Grid.Column="7"
                                        Content="🔄 Yenile"
                                        Style="{StaticResource ModernButton}"
                                        Background="#2196F3"
                                        Foreground="White"
                                        Height="32"
                                        Padding="12,0"
                                        Click="btnRefreshHistory_Click"
                                        Margin="0,0,10,0"/>
                                <Button x:Name="btnHistorySettings"
                                        Grid.Column="8"
                                        Content="⚙️ Ayarlar"
                                        Style="{StaticResource ModernButton}"
                                        Background="#9C27B0"
                                        Foreground="White"
                                        Height="32"
                                        Padding="12,0"
                                        Click="btnHistorySettings_Click"
                                        Margin="0,0,10,0"/>
                            </Grid>
                        </Border>

                        <!-- Geçmiş Listesi -->
                        <Border Grid.Column="0" Grid.Row="2"
                                Background="White"
                                BorderBrush="#E0E0E0"
                                BorderThickness="1"
                                CornerRadius="8"
                                Margin="0,0,20,0">
                            <DataGrid x:Name="HistoryDataGrid"
                                    AutoGenerateColumns="False"
                                    IsReadOnly="True"
                                    SelectionMode="Single"
                                    HeadersVisibility="Column"
                                    FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                    FontSize="13">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Tarih/Saat"
                                                      Binding="{Binding CreatedAt, StringFormat=dd.MM.yyyy HH:mm:ss}"
                                                      Width="150"/>
                                    <DataGridTextColumn Header="TCKN"
                                                      Binding="{Binding TCKN}"
                                                      Width="120"/>
                                    <DataGridTextColumn Header="Ad"
                                                      Binding="{Binding FirstName}"
                                                      Width="100"/>
                                    <DataGridTextColumn Header="Soyad"
                                                      Binding="{Binding LastName}"
                                                      Width="100"/>
                                    <DataGridTextColumn Header="Cinsiyet"
                                                      Binding="{Binding Gender}"
                                                      Width="80"/>
                                    <DataGridTextColumn Header="Telefon"
                                                      Binding="{Binding Phone}"
                                                      Width="120"/>
                                    <DataGridTextColumn Header="E-posta"
                                                      Binding="{Binding Email}"
                                                      Width="150"/>
                                    <DataGridTextColumn Header="Banka"
                                                      Binding="{Binding BankName}"
                                                      Width="120"/>
                                    <DataGridTextColumn Header="Personel Tipi"
                                                      Binding="{Binding PersonelTipi}"
                                                      Width="120"/>
                                    <DataGridTextColumn Header="Durum"
                                                      Binding="{Binding Status}"
                                                      Width="80">
                                        <DataGridTextColumn.ElementStyle>
                                            <Style TargetType="TextBlock">
                                                <Setter Property="HorizontalAlignment" Value="Center"/>
                                                <Style.Triggers>
                                                    <DataTrigger Binding="{Binding Status}" Value="Başarılı">
                                                        <Setter Property="Foreground" Value="#4CAF50"/>
                                                        <Setter Property="FontWeight" Value="Bold"/>
                                                    </DataTrigger>
                                                    <DataTrigger Binding="{Binding Status}" Value="Başarısız">
                                                        <Setter Property="Foreground" Value="#F44336"/>
                                                        <Setter Property="FontWeight" Value="Bold"/>
                                                    </DataTrigger>
                                                </Style.Triggers>
                                            </Style>
                                        </DataGridTextColumn.ElementStyle>
                                    </DataGridTextColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Border>
                    </Grid>
                </TabItem>

                <!-- Ayarlar Tab -->
                <TabItem Style="{StaticResource EmojiTabItem}">
                    <TabItem.Header>
                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                            <Path Data="M12.22 2h-.44a2 2 0 00-2 2v.18a2 2 0 01-1 1.73l-.43.25a2 2 0 01-2 0l-.15-.08a2 2 0 00-2.73.73l-.22.38a2 2 0 00.73 2.73l.15.1a2 2 0 011 1.72v.51a2 2 0 01-1 1.74l-.15.09a2 2 0 00-.73 2.73l.22.38a2 2 0 002.73.73l.15-.08a2 2 0 012 0l.43.25a2 2 0 011 1.73V20a2 2 0 002 2h.44a2 2 0 002-2v-.18a2 2 0 011-1.73l.43-.25a2 2 0 012 0l.15.08a2 2 0 002.73-.73l.22-.39a2 2 0 00-.73-2.73l-.15-.08a2 2 0 01-1-1.74v-.5a2 2 0 011-1.74l.15-.09a2 2 0 00.73-2.73l-.22-.38a2 2 0 00-2.73-.73l-.15.08a2 2 0 01-2 0l-.43-.25a2 2 0 01-1-1.73V4a2 2 0 00-2-2z M12 6.5a5.5 5.5 0 100 11 5.5 5.5 0 000-11z"
                                  Fill="#FF9800"
                                  Width="16"
                                  Height="16"
                                  Margin="0,0,8,0"
                                  Stretch="Uniform"/>
                            <TextBlock Text="Ayarlar" VerticalAlignment="Center"/>
                        </StackPanel>
                    </TabItem.Header>
                    <Grid Margin="20">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <!-- Başlık -->
                        <StackPanel Grid.Row="0" Margin="0,0,0,30">
                            <TextBlock Text="⚙️ Personel Ayarları"
                                       FontSize="24"
                                       FontFamily="pack://application:,,,/Fonts/Poppins-Bold.ttf#Poppins"
                                       FontWeight="Bold"
                                       HorizontalAlignment="Center"
                                       Foreground="#333"/>
                            <TextBlock Text="Personel işlemleri için gerekli giriş bilgilerini düzenleyin"
                                       FontSize="14"
                                       FontFamily="pack://application:,,,/Fonts/Poppins-Regular.ttf#Poppins"
                                       HorizontalAlignment="Center"
                                       Foreground="#666"
                                       Margin="0,5,0,0"/>
                        </StackPanel>

                        <!-- Form Alanı -->
                        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                            <StackPanel Margin="0,0,0,20">
                                <!-- Firma Kodu -->
                                <StackPanel Margin="0,0,0,20">
                                    <Label Content="🏢 Firma Kodu"
                                           Style="{StaticResource ModernLabel}"
                                           FontWeight="Bold"/>
                                    <TextBox x:Name="txtFirmaKodu"
                                            Style="{StaticResource ModernTextBox}"
                                            Height="40"
                                            Margin="0,5,0,0"
                                            Tag="Firma Kodu"/>
                                </StackPanel>

                                <!-- Kullanıcı ID -->
                                <StackPanel Margin="0,0,0,20">
                                    <Label Content="👤 Kullanıcı ID (E-posta)"
                                           Style="{StaticResource ModernLabel}"
                                           FontWeight="Bold"/>
                                    <TextBox x:Name="txtKullaniciId"
                                            Style="{StaticResource ModernTextBox}"
                                            Height="40"
                                            Margin="0,5,0,0"
                                            Tag="Kullanıcı ID"/>
                                </StackPanel>

                                <!-- Şifre -->
                                <StackPanel Margin="0,0,0,20">
                                    <Label Content="🔒 Şifre"
                                           Style="{StaticResource ModernLabel}"
                                           FontWeight="Bold"/>
                                    <PasswordBox x:Name="txtSifre"
                                                Style="{StaticResource ModernPasswordBox}"
                                                Height="40"
                                                Margin="0,5,0,0"
                                                Tag="Şifre"/>
                                </StackPanel>

                                <!-- TOTP Secret -->
                                <StackPanel Margin="0,0,0,20">
                                    <Label Content="🔐 TOTP Secret (2FA Kodu)"
                                           Style="{StaticResource ModernLabel}"
                                           FontWeight="Bold"/>
                                    <TextBox x:Name="txtTotpSecret"
                                            Style="{StaticResource ModernTextBox}"
                                            Height="40"
                                            Margin="0,5,0,0"
                                            Tag="TOTP Secret"/>
                                    <TextBlock Text="Google Authenticator veya benzeri uygulama tarafından oluşturulan secret anahtar"
                                               FontSize="12"
                                               Foreground="#666"
                                               Margin="0,5,0,0"/>
                                </StackPanel>

                                <!-- Headless Mod -->
                                <Border Background="#F5F5F5"
                                        BorderBrush="#BDBDBD"
                                        BorderThickness="1"
                                        CornerRadius="8"
                                        Padding="15"
                                        Margin="0,20,0,0">
                                    <StackPanel>
                                        <TextBlock Text="🌐 Tarayıcı Modu"
                                                   FontSize="16"
                                                   FontWeight="Bold"
                                                   Foreground="#333"
                                                   Margin="0,0,0,10"/>
                                        <StackPanel Orientation="Horizontal" VerticalAlignment="Center">
                                            <CheckBox x:Name="chkHeadlessMode"
                                                      Content="Headless Modu"
                                                      FontSize="13"
                                                      Foreground="#333"
                                                      Margin="0,0,15,0"
                                                      VerticalAlignment="Center"/>
                                            <TextBlock Text="Aktif edildiğinde tarayıcı arka planda çalışır (görünmez)"
                                                       FontSize="12"
                                                       Foreground="#666"
                                                       VerticalAlignment="Center"/>
                                        </StackPanel>
                                    </StackPanel>
                                </Border>
                            </StackPanel>
                        </ScrollViewer>

                        <!-- Butonlar -->
                        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Center">
                            <Button x:Name="btnSaveSettings"
                                    Content="💾 Kaydet"
                                    Style="{StaticResource ModernButton}"
                                    Background="#4CAF50"
                                    Margin="10,0"
                                    Width="120"
                                    Click="btnSaveSettings_Click"/>
                            <Button x:Name="btnResetSettings"
                                    Content="🔄 Sıfırla"
                                    Style="{StaticResource ModernButton}"
                                    Background="#FF9800"
                                    Margin="10,0"
                                    Width="120"
                                    Click="btnResetSettings_Click"/>
                        </StackPanel>
                    </Grid>
                </TabItem>
            </TabControl>

            <!-- Footer - Status, Butonlar ve Bilgiler -->
            <Border Grid.Row="2"
                    Background="#F8F9FA"
                    BorderBrush="#DEE2E6"
                    BorderThickness="1,1,1,0"
                    Padding="20,15">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <!-- Status Bilgisi -->
                    <Border Grid.Column="0"
                            Background="#E3F2FD"
                            BorderBrush="#2196F3"
                            BorderThickness="1"
                            CornerRadius="8"
                            Padding="15,10"
                            Margin="0,0,20,0"
                            MinWidth="300">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0"
                                       x:Name="StatusIcon"
                                       Text="🔄"
                                       FontSize="20"
                                       Margin="0,0,10,0"
                                       VerticalAlignment="Center"/>
                            <StackPanel Grid.Column="1" VerticalAlignment="Center">
                                <TextBlock x:Name="StatusTitle"
                                           Text="Hazırlanıyor..."
                                           FontSize="14"
                                           FontWeight="Bold"
                                           Foreground="#1565C0"/>
                                <TextBlock x:Name="StatusMessage"
                                           Text="Personel ekleme sayfası hazırlanıyor ve log bilgileri burada gösterilecek..."
                                           FontSize="11"
                                           Foreground="#666"
                                           Margin="0,1,0,0"
                                           TextWrapping="Wrap"
                                           MaxWidth="600"/>
                            </StackPanel>
                        </Grid>
                    </Border>

                    <!-- Dosya Bilgisi ve Butonlar -->
                    <StackPanel Grid.Column="1" Orientation="Vertical" VerticalAlignment="Center">
                        <!-- Dosya Bilgisi -->
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10" VerticalAlignment="Center">
                            <TextBlock Text="📄 Seçilen Dosya:"
                                       FontSize="12"
                                       FontWeight="Bold"
                                       Foreground="#333"
                                       VerticalAlignment="Center"
                                       Margin="0,0,10,0"/>
                            <TextBlock x:Name="txtSelectedFile"
                                       Text="Dosya seçilmedi"
                                       FontSize="12"
                                       VerticalAlignment="Center"
                                       Foreground="#666"
                                       TextWrapping="Wrap"
                                       MaxWidth="300"/>
                        </StackPanel>

                    </StackPanel>

                    <!-- Sağ Butonlar -->
                    <StackPanel Grid.Column="3" Orientation="Horizontal" VerticalAlignment="Center" Margin="20,0,0,0">
                        <Button x:Name="btnFooterDownloadTemplate"
                                Content="📥 Şablon İndir"
                                Style="{StaticResource ModernButton}"
                                Background="#4CAF50"
                                Foreground="White"
                                Margin="5,0"
                                Click="btnFooterDownloadTemplate_Click"/>
                        <Button x:Name="btnConvertFromSystemTemplate"
                                Content="🔄 Sistem'den Dönüştür"
                                Style="{StaticResource ModernButton}"
                                Background="#2196F3"
                                Foreground="White"
                                Margin="5,0"
                                Click="btnConvertFromSystemTemplate_Click"/>
                        <Button x:Name="btnOpenConvertFolder"
                                Content="📁 Convert Klasörü"
                                Style="{StaticResource ModernButton}"
                                Background="#FF9800"
                                Foreground="White"
                                Margin="5,0"
                                Click="btnOpenConvertFolder_Click"/>
                        <Button x:Name="btnFooterCancel"
                                Content="❌ İptal"
                                Style="{StaticResource ModernButton}"
                                Background="#F44336"
                                Foreground="White"
                                Margin="5,0"
                                Click="btnFooterCancel_Click"/>
                        <Button x:Name="btnFooterStart"
                                Content="🚀 İşlemi Başlat"
                                Style="{StaticResource ModernButton}"
                                Background="#2196F3"
                                Foreground="White"
                                Margin="5,0"
                                Click="btnFooterStart_Click"/>
                    </StackPanel>
                </Grid>
            </Border>
        </Grid>
    </Grid>
</Window>
